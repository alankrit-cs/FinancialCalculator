<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>SIP Calculator</title>

  <style>
    :root{
      --bg:#edf2ff;
      --muted:#5f6f94;
      --text:#18213a;
      --accent:#4a6bff;
      --accent2:#12a66c;
      --border:rgba(44,68,120,.20);
      --shadow: 0 20px 48px rgba(61,84,137,.20);
      --radius:16px;
      --fieldbg: rgba(255,255,255,.78);
      --panelTop: rgba(255,255,255,.84);
      --panelBottom: rgba(239,245,255,.72);
      --panelHead: rgba(236,243,255,.78);
      --pillBg: rgba(18,166,108,.14);
      --pillBorder: rgba(18,166,108,.28);
      --pillText: #0f7e53;
      --glowA: rgba(74,107,255,.24);
      --glowB: rgba(18,166,108,.18);
      --focus: rgba(74,107,255,.18);
      --highlightBase: rgba(246,250,255,.94);
      --prefix: rgba(52,77,128,.66);
    }
    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
      background: radial-gradient(1200px 600px at 20% 0%, var(--glowA), transparent 60%),
                  radial-gradient(900px 500px at 90% 10%, var(--glowB), transparent 55%),
                  var(--bg);
      color:var(--text);
      min-height:100vh;
      padding: 28px 14px;
      transition: background .25s ease, color .25s ease;
    }
    body.dark{
      --bg:#0b1220;
      --muted:#9fb0d0;
      --text:#eaf0ff;
      --accent:#5b7cfa;
      --accent2:#22c55e;
      --border:rgba(255,255,255,.10);
      --shadow: 0 18px 50px rgba(0,0,0,.45);
      --fieldbg: rgba(16,31,54,.55);
      --panelTop: rgba(255,255,255,.06);
      --panelBottom: rgba(255,255,255,.03);
      --panelHead: rgba(0,0,0,.18);
      --pillBg: rgba(34,197,94,.16);
      --pillBorder: rgba(34,197,94,.32);
      --pillText: rgba(220,255,235,.95);
      --glowA: rgba(91,124,250,.25);
      --glowB: rgba(34,197,94,.18);
      --focus: rgba(91,124,250,.15);
      --highlightBase: rgba(16,31,54,.55);
      --prefix: rgba(234,240,255,.75);
    }
    .wrap{ max-width: 980px; margin: 0 auto; display:grid; gap:16px; }
    header{ padding: 6px 4px 0; }
    .topBar{ display:flex; align-items:center; justify-content:space-between; gap:12px; }
    h1{ font-size: 28px; margin:0; letter-spacing:.2px; }
    .subtitle{ color: var(--muted); font-size: 14px; margin-top:6px; }
    .themeToggle{
      border: 1px solid var(--border);
      background: var(--fieldbg);
      color: var(--text);
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 10px 12px;
      min-width: 118px;
      justify-content: center;
    }
    .themeToggle .icon{ font-size: 15px; }

    .grid{
      display:grid;
      grid-template-columns: 1.15fr .85fr;
      gap:16px;
    }
    @media (max-width: 900px){
      .grid{ grid-template-columns: 1fr; }
    }

    .panel{
      background: linear-gradient(180deg, var(--panelTop), var(--panelBottom));
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .panelHead{
      padding: 14px 16px;
      border-bottom: 1px solid var(--border);
      background: var(--panelHead);
      font-weight: 800;
      letter-spacing:.2px;
    }
    .panelBody{ padding: 16px; }

    .form{ display:grid; gap: 12px; }

    .line{ display:grid; gap:12px; }
    .line.two{ grid-template-columns: 1fr 1fr; }
    @media (max-width: 520px){
      .line.two{ grid-template-columns: 1fr; }
    }

    .field{ display:grid; gap: 7px; }
    .field label{ color: var(--muted); font-size: 13px; }

    .inputWrap{ position:relative; }
    .prefix{
      position:absolute; left: 12px; top: 50%;
      transform: translateY(-50%);
      color: var(--prefix);
      font-size: 14px; pointer-events:none;
    }

    input, select{
      width:100%;
      padding: 12px 12px 12px 36px;
      border-radius: 12px;
      border: 1px solid var(--border);
      background: var(--fieldbg);
      color: var(--text);
      font-size: 15px;
      outline:none;
    }
    select{ padding-left: 12px; }
    input:focus, select:focus{
      border-color: rgba(91,124,250,.65);
      box-shadow: 0 0 0 4px var(--focus);
    }
    input[type="number"]::-webkit-outer-spin-button,
    input[type="number"]::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }

    .actions{
      display:flex;
      gap:10px;
      margin-top: 6px;
      flex-wrap:wrap;
    }
    button{
      border:0;
      border-radius: 12px;
      padding: 12px 14px;
      font-weight: 800;
      cursor:pointer;
      font-size: 14px;
      transition: transform .05s ease, filter .15s ease;
    }
    button:active{ transform: translateY(1px); }
    .btnPrimary{
      background: linear-gradient(135deg, rgba(91,124,250,1), rgba(91,124,250,.75));
      color:white;
    }
    .btnGhost{
      background: var(--fieldbg);
      color: var(--text);
      border: 1px solid var(--border);
    }

    .disclaimer{
      margin-top: 10px;
      color: var(--muted);
      font-size: 12px;
      line-height: 1.4;
      padding: 10px 12px;
      border-radius: 12px;
      border: 1px dashed var(--border);
      background: var(--panelBottom);
    }

    .resultStack{ display:grid; gap: 12px; }
    .highlight{
      background: radial-gradient(700px 220px at 15% 0%, rgba(91,124,250,.35), transparent 55%),
                  radial-gradient(700px 240px at 90% 40%, rgba(34,197,94,.22), transparent 60%),
                  var(--highlightBase);
      border: 1px solid color-mix(in srgb, var(--accent) 45%, transparent);
      border-radius: 16px;
      padding: 14px 14px 12px;
    }
    .pill{
      display:inline-flex; align-items:center;
      padding: 4px 10px; border-radius: 999px;
      background: var(--pillBg);
      border: 1px solid var(--pillBorder);
      color: var(--pillText);
      font-weight: 900; font-size: 12px;
      gap:6px;
    }
    .moneyBig{ font-size: 34px; font-weight: 950; margin-top: 8px; line-height: 1.05; }
    .mutedLine{ color: var(--muted); font-size: 13px; margin-top: 6px; }

    .miniCards{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    @media (max-width: 520px){
      .miniCards{ grid-template-columns:1fr; }
    }
    .mini{
      background: var(--fieldbg);
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 12px;
    }
    .mini .k{
      color: var(--muted);
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing:.14em;
    }
    .mini .v{ margin-top: 6px; font-weight: 950; font-size: 18px; }

    .hidden{ display:none; }
  </style>
</head>

<body>
  <div class="wrap">
    <header>
      <div class="topBar">
        <h1>SIP Calculator</h1>
        <button class="themeToggle" id="themeToggle" type="button" onclick="toggleTheme()">
          <span class="icon" id="themeIcon">üåô</span>
          <span id="themeLabel">Dark mode</span>
        </button>
      </div>
    </header>

    <div class="grid">
      <section class="panel">
        <div class="panelHead">Inputs</div>
        <div class="panelBody">
          <div class="form">

            <div class="line">
              <div class="field">
                <label for="lumpSum">Lump Sum</label>
                <div class="inputWrap">
                  <div class="prefix">‚Çπ</div>
                  <input type="number" id="lumpSum" value="0" min="0" inputmode="decimal" />
                </div>
              </div>
            </div>

            <div class="line two">
              <div class="field">
                <label for="depositAmount">Regular Deposit Amount</label>
                <div class="inputWrap">
                  <div class="prefix">‚Çπ</div>
                  <input type="number" id="depositAmount" placeholder="e.g., 2000" min="0" inputmode="decimal" />
                </div>
              </div>

              <div class="field">
                <label for="depositFreq">Deposit Frequency</label>
                <select id="depositFreq">
                  <option value="monthly" selected>Monthly</option>
                  <option value="quarterly">Quarterly</option>
                  <option value="halfYearly">Half Yearly</option>
                  <option value="yearly">Yearly</option>
                </select>
              </div>
            </div>

            <div class="line two">
              <div class="field">
                <label for="stepUpValue">Increase/Decrease Deposit Every Year</label>
                <div class="inputWrap">
                  <div class="prefix">¬±</div>
                  <input type="number" id="stepUpValue" value="0" inputmode="decimal" />
                </div>
              </div>

              <div class="field">
                <label for="stepUpUnit">Step-up Unit</label>
                <select id="stepUpUnit">
                  <option value="rupees">Rupees</option>
                  <option value="percent" selected>Percentage (%)</option>
                </select>
              </div>
            </div>

            <div class="line two">
              <div class="field">
                <label for="termValue">Term</label>
                <div class="inputWrap">
                  <div class="prefix">#</div>
                  <input type="number" id="termValue" placeholder="e.g., 20" min="0" inputmode="numeric" />
                </div>
              </div>

              <div class="field">
                <label for="termUnit">Term Unit</label>
                <select id="termUnit">
                  <option value="years" selected>Years</option>
                  <option value="months">Months</option>
                </select>
              </div>
            </div>

            <div class="line">
              <div class="field">
                <label for="rate">Expected Return (%)</label>
                <div class="inputWrap">
                  <div class="prefix">%</div>
                  <input type="number" id="rate" placeholder="e.g., 12" min="0" inputmode="decimal" />
                </div>
              </div>
            </div>

            <div class="actions">
              <button class="btnPrimary" onclick="calculateSIP()">Calculate</button>
              <button class="btnGhost" onclick="resetForm()">Reset</button>
            </div>

          </div>

          <div class="disclaimer">
            SIP returns are not guaranteed and may vary based on market conditions.
          </div>
        </div>
      </section>

      <section class="panel">
        <div class="panelHead">Results</div>
        <div class="panelBody">
          <div id="result" class="resultStack hidden">
            <div class="highlight">
              <span class="pill">‚≠ê Maturity Amount</span>
              <div class="moneyBig" id="maturityText">Rs. 0.00</div>
              <div class="mutedLine" id="investedHint">Total invested: Rs. 0.00</div>
            </div>

            <div class="miniCards">
              <div class="mini">
                <div class="k">Total Deposits</div>
                <div class="v" id="depositText">Rs. 0.00</div>
              </div>
              <div class="mini">
                <div class="k">Total Returns</div>
                <div class="v" id="returnsText">Rs. 0.00</div>
              </div>
            </div>
          </div>

          <div id="emptyState" class="mutedLine">
            Enter values and hit <b>Calculate</b>.
          </div>
        </div>
      </section>
    </div>
  </div>

  <script>
    function formatINR(value) {
      return "Rs. " + new Intl.NumberFormat("en-IN", {
        minimumFractionDigits: 2,
        maximumFractionDigits: 2
      }).format(value);
    }

    function getFrequencyConfig(freq) {
      switch (freq) {
        case "monthly": return { n: 12, p: 1 };
        case "quarterly": return { n: 4, p: 3 };
        case "halfYearly": return { n: 2, p: 6 };
        case "yearly": return { n: 1, p: 12 };
        default: return { n: 12, p: 1 };
      }
    }

    function avgRemainingMonthsFullYear(n, p) {
      return 12 - (p * (n - 1) / 2);
    }

    function depositCountPartial(remMonths, p) {
      if (remMonths <= 0) return 0;
      return Math.floor((remMonths - 1) / p) + 1;
    }
    function avgRemainingMonthsPartial(remMonths, p) {
      if (remMonths <= 0) return 0;
      const count = depositCountPartial(remMonths, p);
      return remMonths - (p * (count - 1) / 2);
    }

    function applyStepUp(depPerPeriod, stepUpValue, stepUpUnit) {
      if (stepUpUnit === "rupees") return depPerPeriod + stepUpValue;
      return depPerPeriod * (1 + stepUpValue / 100);
    }


    function updateThemeToggle(isDark) {
      document.getElementById("themeIcon").textContent = isDark ? "‚òÄÔ∏è" : "üåô";
      document.getElementById("themeLabel").textContent = isDark ? "Light mode" : "Dark mode";
    }

    function toggleTheme() {
      const isDark = document.body.classList.toggle("dark");
      localStorage.setItem("sip-theme", isDark ? "dark" : "light");
      updateThemeToggle(isDark);
    }

    function initTheme() {
      const stored = localStorage.getItem("sip-theme");
      const isDark = stored === "dark";
      document.body.classList.toggle("dark", isDark);
      updateThemeToggle(isDark);
    }

    function calculateSIP() {
      const lumpSum = parseFloat(document.getElementById("lumpSum").value) || 0;
      const depositPerPeriod0 = parseFloat(document.getElementById("depositAmount").value) || 0;

      const freq = document.getElementById("depositFreq").value;
      const stepUpValue = parseFloat(document.getElementById("stepUpValue").value) || 0;
      const stepUpUnit = document.getElementById("stepUpUnit").value;

      const termValue = parseInt(document.getElementById("termValue").value) || 0;
      const termUnit = document.getElementById("termUnit").value;

      const annualRate = parseFloat(document.getElementById("rate").value) || 0;

      if (annualRate <= 0 || termValue <= 0 || depositPerPeriod0 <= 0) {
        alert("Please enter Regular Deposit Amount, Expected Return (%), and Term.");
        return;
      }

      const { n, p } = getFrequencyConfig(freq);
      const r = annualRate / 100;

      const totalMonths = (termUnit === "years") ? (termValue * 12) : termValue;
      const fullYears = Math.floor(totalMonths / 12);
      const remMonths = totalMonths % 12;

      let totalDeposits = lumpSum;
      let depPerPeriod = depositPerPeriod0;

      for (let y = 0; y < fullYears; y++) {
        totalDeposits += depPerPeriod * n;
        depPerPeriod = applyStepUp(depPerPeriod, stepUpValue, stepUpUnit);
      }
      if (remMonths > 0) {
        const cnt = depositCountPartial(remMonths, p);
        totalDeposits += depPerPeriod * cnt;
      }

      let corpus = lumpSum;
      depPerPeriod = depositPerPeriod0;

      for (let y = 0; y < fullYears; y++) {
        corpus *= (1 + r);

        const avgMonths = avgRemainingMonthsFullYear(n, p);
        const yearDeposit = depPerPeriod * n;
        corpus += yearDeposit * (1 + r * (avgMonths / 12));

        depPerPeriod = applyStepUp(depPerPeriod, stepUpValue, stepUpUnit);
      }

      if (remMonths > 0) {
        corpus *= (1 + r * (remMonths / 12));

        const cnt = depositCountPartial(remMonths, p);
        const avgRem = avgRemainingMonthsPartial(remMonths, p);
        const partDeposit = depPerPeriod * cnt;
        corpus += partDeposit * (1 + r * (avgRem / 12));
      }

      const totalReturns = corpus - totalDeposits;

      document.getElementById("result").classList.remove("hidden");
      document.getElementById("emptyState").classList.add("hidden");

      document.getElementById("maturityText").textContent = formatINR(corpus);
      document.getElementById("depositText").textContent = formatINR(totalDeposits);
      document.getElementById("returnsText").textContent = formatINR(totalReturns);
      document.getElementById("investedHint").textContent = "Total invested: " + formatINR(totalDeposits);
    }

    initTheme();

    function resetForm() {
      document.getElementById("lumpSum").value = 0;
      document.getElementById("depositAmount").value = "";
      document.getElementById("depositFreq").value = "monthly";
      document.getElementById("stepUpValue").value = 0;
      document.getElementById("stepUpUnit").value = "percent";
      document.getElementById("termValue").value = "";
      document.getElementById("termUnit").value = "years";
      document.getElementById("rate").value = "";

      document.getElementById("result").classList.add("hidden");
      document.getElementById("emptyState").classList.remove("hidden");
    }
  </script>
</body>
</html>
