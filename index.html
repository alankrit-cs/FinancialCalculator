<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>SIP Calculator</title>
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Crect width='64' height='64' rx='14' fill='%234d6dff'/%3E%3Cpath d='M14 42h36M18 34l8-9 8 6 12-14' stroke='white' stroke-width='5' stroke-linecap='round' stroke-linejoin='round' fill='none'/%3E%3C/svg%3E" />

  <style>
    :root{
      --bg:#f0f4ff;
      --text:#1b2442;
      --muted:#5f7099;
      --panel:#ffffff;
      --border:rgba(65,91,150,.22);
      --field:#f9fbff;
      --accent:#4d6dff;
      --accent2:#10b981;
      --accent3:#ff845d;
      --shadow:0 12px 30px rgba(74,100,158,.18);
      --focus:rgba(77,109,255,.2);
      --grid:rgba(90,114,170,.16);
      --lineA:#4d6dff;
      --lineB:#10b981;
      --radius:16px;
    }
    body.dark{
      --bg:#0d1425;
      --text:#eaf0ff;
      --muted:#a2b2d4;
      --panel:#121d34;
      --border:rgba(255,255,255,.12);
      --field:#0f1b32;
      --accent:#6f8bff;
      --accent2:#34d399;
      --accent3:#ff9b79;
      --shadow:0 16px 38px rgba(0,0,0,.45);
      --focus:rgba(111,139,255,.25);
      --grid:rgba(255,255,255,.13);
      --lineA:#8ca2ff;
      --lineB:#44e2a3;
    }
    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
      background: linear-gradient(150deg, var(--bg), color-mix(in srgb, var(--bg) 70%, #dff7ef));
      color:var(--text);
      min-height:100vh;
      padding:18px 12px 20px;
    }
    .wrap{ max-width:1120px; margin:0 auto; display:grid; gap:12px; }
    .topbar, .panel{
      background:var(--panel);
      border:1px solid var(--border);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
    }
    .topbar{
      padding:12px 14px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
    }
    h1{ margin:0; font-size:24px; }
    .sub{ color:var(--muted); font-size:13px; margin-top:4px; }
    .themeToggle{
      border:1px solid var(--border);
      background:var(--field);
      color:var(--text);
      border-radius:12px;
      padding:9px 12px;
      font-weight:700;
      cursor:pointer;
    }

    .layout{ display:grid; grid-template-columns:360px 1fr; gap:12px; align-items:start; }
    @media (max-width:980px){ .layout{ grid-template-columns:1fr; } }

    .head{ padding:12px 14px; border-bottom:1px solid var(--border); font-weight:900; letter-spacing:.03em; }
    .body{ padding:14px; }
    .form{ display:grid; gap:10px; }
    .line{ display:grid; gap:10px; }
    .line.two{ grid-template-columns:1fr 1fr; }
    @media (max-width:560px){ .line.two{ grid-template-columns:1fr; } }
    .field{ display:grid; gap:6px; }
    .field label{ color:var(--muted); font-size:12px; font-weight:700; }
    .inputWrap{ position:relative; }
    .prefix{ position:absolute; left:10px; top:50%; transform:translateY(-50%); color:var(--muted); font-size:13px; }
    input, select{
      width:100%;
      border:1px solid var(--border);
      background:var(--field);
      color:var(--text);
      border-radius:12px;
      font-size:14px;
      padding:10px 11px 10px 32px;
      outline:none;
    }
    select{ padding-left:11px; }
    input:focus, select:focus{ box-shadow:0 0 0 4px var(--focus); }
    .actions{ display:flex; flex-wrap:wrap; gap:8px; }
    button{ border:0; border-radius:12px; padding:10px 12px; font-weight:800; cursor:pointer; }
    .btnPrimary{ background:linear-gradient(135deg, var(--accent), color-mix(in srgb, var(--accent) 70%, #fff)); color:#fff; }
    .btnGhost{ background:var(--field); color:var(--text); border:1px solid var(--border); }

    .right{ display:grid; gap:10px; }
    .metrics{ display:grid; grid-template-columns:1.2fr 1fr 1fr; gap:10px; }
    @media (max-width:740px){ .metrics{ grid-template-columns:1fr; } }
    .metric{
      background:var(--field);
      border:1px solid var(--border);
      border-radius:14px;
      padding:12px;
    }
    .k{ color:var(--muted); font-size:11px; text-transform:uppercase; letter-spacing:.1em; font-weight:800; }
    .v{ font-size:28px; font-weight:900; margin-top:5px; }
    .hint{ font-size:13px; color:var(--muted); margin-top:6px; }

    .charts{ display:grid; grid-template-columns:1.4fr 1fr; gap:10px; }
    @media (max-width:980px){ .charts{ grid-template-columns:1fr; } }
    .chartCard{
      background:var(--field);
      border:1px solid var(--border);
      border-radius:14px;
      padding:10px;
      min-height:220px;
      display:grid;
      gap:8px;
      grid-template-rows:auto 1fr;
    }
    .title{ font-size:12px; color:var(--muted); text-transform:uppercase; letter-spacing:.08em; font-weight:900; }
    canvas{ width:100%; height:175px; display:block; }
    .mixWrap{ display:grid; grid-template-columns:130px 1fr; gap:10px; align-items:center; }
    .donut{
      width:130px;
      height:130px;
      border-radius:50%;
      background:conic-gradient(var(--accent2) 0deg, var(--accent2) 260deg, var(--accent3) 260deg 360deg);
      position:relative;
      margin:auto;
    }
    .donut::after{
      content:"";
      position:absolute;
      inset:19px;
      border-radius:50%;
      background:var(--field);
      border:1px solid var(--border);
    }
    .legend{ display:grid; gap:8px; }
    .item{ display:flex; justify-content:space-between; align-items:center; font-size:13px; }
    .dot{ width:10px; height:10px; border-radius:50%; display:inline-block; margin-right:8px; }
  </style>
</head>

<body>
  <div class="wrap">
    <header class="topbar">
      <div>
        <h1>SIP Calculator</h1>
        <div class="sub">Simple planner with two clear charts</div>
      </div>
      <button class="themeToggle" id="themeToggle" type="button" onclick="toggleTheme()">Dark mode</button>
    </header>

    <div class="layout">
      <section class="panel">
        <div class="head">Inputs</div>
        <div class="body">
          <div class="form">
            <div class="line">
              <div class="field">
                <label for="lumpSum">Lump Sum</label>
                <div class="inputWrap">
                  <div class="prefix">₹</div>
                  <input type="number" id="lumpSum" value="0" min="0" inputmode="decimal" />
                </div>
              </div>
            </div>
            <div class="line two">
              <div class="field">
                <label for="depositAmount">Regular Deposit Amount</label>
                <div class="inputWrap">
                  <div class="prefix">₹</div>
                  <input type="number" id="depositAmount" placeholder="e.g., 2000" min="0" inputmode="decimal" />
                </div>
              </div>
              <div class="field">
                <label for="depositFreq">Deposit Frequency</label>
                <select id="depositFreq">
                  <option value="monthly" selected>Monthly</option>
                  <option value="quarterly">Quarterly</option>
                  <option value="halfYearly">Half Yearly</option>
                  <option value="yearly">Yearly</option>
                </select>
              </div>
            </div>
            <div class="line two">
              <div class="field">
                <label for="stepUpValue">Increase/Decrease Deposit Every Year</label>
                <div class="inputWrap">
                  <div class="prefix">±</div>
                  <input type="number" id="stepUpValue" value="0" inputmode="decimal" />
                </div>
              </div>
              <div class="field">
                <label for="stepUpUnit">Step-up Unit</label>
                <select id="stepUpUnit">
                  <option value="rupees">Rupees</option>
                  <option value="percent" selected>Percentage (%)</option>
                </select>
              </div>
            </div>
            <div class="line two">
              <div class="field">
                <label for="termValue">Term</label>
                <div class="inputWrap">
                  <div class="prefix">#</div>
                  <input type="number" id="termValue" placeholder="e.g., 20" min="0" inputmode="numeric" />
                </div>
              </div>
              <div class="field">
                <label for="termUnit">Term Unit</label>
                <select id="termUnit">
                  <option value="years" selected>Years</option>
                  <option value="months">Months</option>
                </select>
              </div>
            </div>
            <div class="line">
              <div class="field">
                <label for="rate">Expected Return (%)</label>
                <div class="inputWrap">
                  <div class="prefix">%</div>
                  <input type="number" id="rate" placeholder="e.g., 12" min="0" inputmode="decimal" />
                </div>
              </div>
            </div>
            <div class="actions">
              <button class="btnPrimary" onclick="calculateSIP()">Calculate</button>
              <button class="btnGhost" onclick="resetForm()">Reset</button>
            </div>
          </div>
        </div>
      </section>

      <section class="right">
        <div class="metrics">
          <div class="metric">
            <div class="k">Maturity Amount</div>
            <div class="v" id="maturityText">Rs. 0.00</div>
            <div class="hint" id="investedHint">Total invested: Rs. 0.00</div>
          </div>
          <div class="metric">
            <div class="k">Total Deposits</div>
            <div class="v" id="depositText">Rs. 0.00</div>
          </div>
          <div class="metric">
            <div class="k">Total Returns</div>
            <div class="v" id="returnsText">Rs. 0.00</div>
          </div>
        </div>

        <div class="charts">
          <div class="chartCard">
            <div class="title">Investment vs Portfolio Value</div>
            <canvas id="lineChart" width="650" height="175"></canvas>
          </div>
          <div class="chartCard">
            <div class="title">Mix at Maturity</div>
            <div class="mixWrap">
              <div class="donut" id="mixDonut"></div>
              <div class="legend">
                <div class="item"><span><span class="dot" style="background:var(--accent2)"></span>Invested</span><strong id="donutInvested">Rs. 0.00</strong></div>
                <div class="item"><span><span class="dot" style="background:var(--accent3)"></span>Returns</span><strong id="donutReturns">Rs. 0.00</strong></div>
                <div class="item"><span>Returns share</span><strong id="returnShare">0%</strong></div>
              </div>
            </div>
          </div>
        </div>
      </section>
    </div>
  </div>

  <script>
    function formatINR(value) {
      return "Rs. " + new Intl.NumberFormat("en-IN", {
        minimumFractionDigits: 2,
        maximumFractionDigits: 2
      }).format(value);
    }

    function getFrequencyConfig(freq) {
      switch (freq) {
        case "monthly": return { p: 1 };
        case "quarterly": return { p: 3 };
        case "halfYearly": return { p: 6 };
        case "yearly": return { p: 12 };
        default: return { p: 1 };
      }
    }

    function applyStepUp(value, stepUpValue, stepUpUnit) {
      if (stepUpUnit === "rupees") return value + stepUpValue;
      return value * (1 + stepUpValue / 100);
    }

    function buildProjection(params) {
      const monthlyRate = params.annualRate / 100 / 12;
      const freqStep = getFrequencyConfig(params.freq).p;
      const points = [];

      let corpus = params.lumpSum;
      let invested = params.lumpSum;
      let depPerPeriod = params.depositPerPeriod;

      points.push({ month: 0, invested, corpus });

      for (let m = 1; m <= params.totalMonths; m++) {
        if ((m - 1) % 12 === 0 && m > 1) {
          depPerPeriod = Math.max(0, applyStepUp(depPerPeriod, params.stepUpValue, params.stepUpUnit));
        }
        if ((m - 1) % freqStep === 0) {
          invested += depPerPeriod;
          corpus += depPerPeriod;
        }
        corpus *= (1 + monthlyRate);
        points.push({ month: m, invested, corpus });
      }

      return { points, invested, corpus, returns: corpus - invested };
    }

    function drawAxes(ctx, width, height, left, top, right, bottom) {
      ctx.strokeStyle = getComputedStyle(document.body).getPropertyValue("--grid");
      ctx.lineWidth = 1;
      for (let i = 0; i <= 4; i++) {
        const y = top + ((height - top - bottom) * i / 4);
        ctx.beginPath();
        ctx.moveTo(left, y);
        ctx.lineTo(width - right, y);
        ctx.stroke();
      }
      ctx.beginPath();
      ctx.moveTo(left, top);
      ctx.lineTo(left, height - bottom);
      ctx.lineTo(width - right, height - bottom);
      ctx.stroke();
    }

    function drawLineGraph(points) {
      const canvas = document.getElementById("lineChart");
      const ctx = canvas.getContext("2d");
      const w = canvas.width;
      const h = canvas.height;
      const pad = { l: 42, t: 14, r: 12, b: 24 };

      ctx.clearRect(0, 0, w, h);
      drawAxes(ctx, w, h, pad.l, pad.t, pad.r, pad.b);

      const maxY = Math.max(...points.map(p => Math.max(p.invested, p.corpus)), 1);
      const maxX = Math.max(points[points.length - 1].month, 1);
      const mapX = x => pad.l + (x / maxX) * (w - pad.l - pad.r);
      const mapY = y => h - pad.b - (y / maxY) * (h - pad.t - pad.b);

      ctx.strokeStyle = getComputedStyle(document.body).getPropertyValue("--lineB");
      ctx.lineWidth = 2.2;
      ctx.beginPath();
      points.forEach((p, i) => i === 0 ? ctx.moveTo(mapX(p.month), mapY(p.invested)) : ctx.lineTo(mapX(p.month), mapY(p.invested)));
      ctx.stroke();

      ctx.strokeStyle = getComputedStyle(document.body).getPropertyValue("--lineA");
      ctx.beginPath();
      points.forEach((p, i) => i === 0 ? ctx.moveTo(mapX(p.month), mapY(p.corpus)) : ctx.lineTo(mapX(p.month), mapY(p.corpus)));
      ctx.stroke();

      ctx.fillStyle = getComputedStyle(document.body).getPropertyValue("--muted");
      ctx.font = "11px Inter, system-ui";
      ctx.fillText("Invested", w - 148, 14);
      ctx.fillStyle = getComputedStyle(document.body).getPropertyValue("--lineB");
      ctx.fillRect(w - 204, 6, 12, 2);
      ctx.fillStyle = getComputedStyle(document.body).getPropertyValue("--muted");
      ctx.fillText("Portfolio", w - 75, 14);
      ctx.fillStyle = getComputedStyle(document.body).getPropertyValue("--lineA");
      ctx.fillRect(w - 131, 6, 12, 2);
    }

    function updateDonut(invested, returns) {
      const total = Math.max(invested + returns, 1);
      const investDeg = (invested / total) * 360;
      document.getElementById("mixDonut").style.background = `conic-gradient(var(--accent2) 0deg, var(--accent2) ${investDeg}deg, var(--accent3) ${investDeg}deg 360deg)`;
      document.getElementById("donutInvested").textContent = formatINR(invested);
      document.getElementById("donutReturns").textContent = formatINR(returns);
      document.getElementById("returnShare").textContent = ((returns / total) * 100).toFixed(1) + "%";
    }

    function updateThemeToggle(isDark) {
      document.getElementById("themeToggle").textContent = isDark ? "Light mode" : "Dark mode";
    }

    function toggleTheme() {
      const isDark = document.body.classList.toggle("dark");
      localStorage.setItem("sip-theme", isDark ? "dark" : "light");
      updateThemeToggle(isDark);
      if (window.lastProjection) drawLineGraph(window.lastProjection.points);
    }

    function initTheme() {
      const isDark = localStorage.getItem("sip-theme") === "dark";
      document.body.classList.toggle("dark", isDark);
      updateThemeToggle(isDark);
    }

    function calculateSIP() {
      const lumpSum = parseFloat(document.getElementById("lumpSum").value) || 0;
      const depositPerPeriod = parseFloat(document.getElementById("depositAmount").value) || 0;
      const freq = document.getElementById("depositFreq").value;
      const stepUpValue = parseFloat(document.getElementById("stepUpValue").value) || 0;
      const stepUpUnit = document.getElementById("stepUpUnit").value;
      const termValue = parseInt(document.getElementById("termValue").value) || 0;
      const termUnit = document.getElementById("termUnit").value;
      const annualRate = parseFloat(document.getElementById("rate").value) || 0;

      if (annualRate <= 0 || termValue <= 0 || depositPerPeriod <= 0) {
        alert("Please enter Regular Deposit Amount, Expected Return (%), and Term.");
        return;
      }

      const totalMonths = termUnit === "years" ? termValue * 12 : termValue;
      const projection = buildProjection({
        lumpSum,
        depositPerPeriod,
        freq,
        stepUpValue,
        stepUpUnit,
        annualRate,
        totalMonths
      });

      window.lastProjection = projection;
      document.getElementById("maturityText").textContent = formatINR(projection.corpus);
      document.getElementById("depositText").textContent = formatINR(projection.invested);
      document.getElementById("returnsText").textContent = formatINR(projection.returns);
      document.getElementById("investedHint").textContent = "Total invested: " + formatINR(projection.invested);
      drawLineGraph(projection.points);
      updateDonut(projection.invested, projection.returns);
    }

    function resetForm() {
      document.getElementById("lumpSum").value = 0;
      document.getElementById("depositAmount").value = "";
      document.getElementById("depositFreq").value = "monthly";
      document.getElementById("stepUpValue").value = 0;
      document.getElementById("stepUpUnit").value = "percent";
      document.getElementById("termValue").value = "";
      document.getElementById("termUnit").value = "years";
      document.getElementById("rate").value = "";
      window.lastProjection = null;
      document.getElementById("maturityText").textContent = "Rs. 0.00";
      document.getElementById("depositText").textContent = "Rs. 0.00";
      document.getElementById("returnsText").textContent = "Rs. 0.00";
      document.getElementById("investedHint").textContent = "Total invested: Rs. 0.00";
      drawLineGraph([{month:0, invested:0, corpus:0}, {month:1, invested:0, corpus:0}]);
      updateDonut(0, 0);
    }

    initTheme();
    resetForm();
  </script>
</body>
</html>
